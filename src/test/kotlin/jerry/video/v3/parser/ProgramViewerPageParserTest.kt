package jerry.video.v3.parser

import jerry.video.v3.model.ProgramPlayer
import org.junit.Test
import java.io.Reader
import java.nio.charset.Charset
import kotlin.test.assertEquals

class ProgramViewerPageParserTest {
    @Test
    fun `parse() - first page`() {
        val testInstance = createParser("version3_program_viewer_page_first.html")
        val programViewer = testInstance.parse()
        assertEquals(
            expected = "epList.aspx?q=RMxVm02CPdrbqCPzoykE%2bLljVQ4qzRlnVw1G4VXDbgVBmKtAgUh8ITocgrxAStfI",
            actual = programViewer.url
        )
        assertEquals(
            expected = listOf(
                ProgramPlayer(
                    title = "영화가 좋다 (Today)",
                    url = "https://www.supervid.net/2019/12/e678191221.html"
                ),
                ProgramPlayer(
                    title = "영화가 좋다 (Today)",
                    url = "https://jetload.net/e/KW0YMPZybeUM"
                )
            ),
            actual = programViewer.playerList
        )
        assertEquals(
            expected = null,
            actual = programViewer.prevKey
        )
        assertEquals(
            expected = mapOf(
                "__EVENTTARGET" to "ctl00\$ContentPlaceHolder1\$epList1\$rptPager\$ctl05\$lnkPage",
                "__EVENTARGUMENT" to "",
                "__VIEWSTATE" to "/wEPDwUKMTc2Nzg5OTY0NQ9kFgJmD2QWBgIBD2QWAgIIDxYCHgRUZXh0Be0JPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0KICAgICAgdmFyIG1vYmlsZUNoZWNrID0gZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHVzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQ7DQogICAgICBpZiAodXNlckFnZW50ID09IG51bGwpIHsNCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICAgIHZhciBtb2JpbGUxID0gdXNlckFnZW50Lm1hdGNoKCJpUGhvbmV8aVBvZHxpUGFkfEFuZHJvaWR8V2luZG93cyBDRXxCbGFja0JlcnJ5fFN5bWJpYW58V2luZG93cyBQaG9uZXx3ZWJPU3xPcGVyYSBNaW5pfE9wZXJhIE1vYml8UE9MQVJJU3xJRU1vYmlsZXxsZ3RlbGVjb218bm9raWF8U29ueUVyaWNzc29uIik7DQogICAgICB2YXIgbW9iaWxlMiA9IHVzZXJBZ2VudC5tYXRjaCgiTEd8U0FNU1VOR3xTYW1zdW5nIik7DQogICAgICBpZiAobW9iaWxlMSB8fCBtb2JpbGUyKSB7DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQogICAgICB9DQogICAgICBpZiAoIW1vYmlsZUNoZWNrKCkpIHsNCiAgICAgIGRvY3VtZW50LndyaXRlKCI8aWZyYW1lIHNyYz0nLy93d3cubWVkaWFjYXRlZ29yeS5jb20vc2VydmxldC9pYWRibj9mcm9tPSIrZXNjYXBlKGRvY3VtZW50LnJlZmVycmVyKSsiJnM9MTc3MzImcHNiPTk5JyBzY3JvbGxpbmc9J25vJyBmcmFtZWJvcmRlcj0wIHdpZHRoPTAgaGVpZ2h0PTA+PC9pZnJhbWU+Iik7DQogICAgICB9DQogICAgICA8L3NjcmlwdD4NCiAgICAgIA0KICAgICAgPHNjcmlwdCBhc3luYyB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0KICAgICAgKGZ1bmN0aW9uKGNsLCBpLCBjLCBrLCBtLCBvLCBuKSB7DQogICAgICBtID0gY2wubG9jYXRpb24ucHJvdG9jb2wgKyBjOyBvID0gY2wucmVmZXJyZXI7IG0gKz0gJyZtb25fcmY9JyArIGVuY29kZVVSSUNvbXBvbmVudChvKTsNCiAgICAgIG4gPSAnPCcgKyBpICsgJyB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iJyArIG0gKyAnIj48LycgKyBpICsgJz4nOyBjbC53cml0ZWxuKG4pOw0KICAgICAgfSkoZG9jdW1lbnQsICdzY3JpcHQnLCAnLy90YWIyLmNsaWNrbW9uLmNvLmtyL3BvcC9jbV9tYXQucGhwP1BvcEFkPTEwNTMwODgnKTsNCiAgICAgIDwvc2NyaXB0Pg0KDQogICAgICA8c2NyaXB0IGFzeW5jIHNyYz0iLy9nZXQub3B0YWQzNjAuaW8vc2YvOWIzYTljZmYtNTI2MS00OTNiLWJmZTYtMzBlZTllNzA4OWM5L3BsdWdpbi5taW4uanMiPjwvc2NyaXB0PmQCAw9kFgYCAQ8WAh8ABZsBPGlucyBjbGFzcz0ic3RhdGljcHViYWRzODkzNTQiDQogICAgICBkYXRhLXNpemVzLWRlc2t0b3A9IjcyOHg5MCw2MTB4OTAsNjQweDEwMCw2NDB4OTAsNjUweDEwMCw2OTB4MTAwLDcwMHgxMDAsNzIwLDEwMCINCiAgICAgIGRhdGEtc2xvdD0iMSI+DQogICAgICA8L2lucz5kAgcPZBYCAgUPDxYCHgdWaXNpYmxlaGRkAgkPZBYCAgEPDxYKHgdfcXNjb2xsMpwEAAEAAAD/////AQAAAAAAAAAMAgAAAE1TeXN0ZW0uV2ViLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49YjAzZjVmN2YxMWQ1MGEzYQUBAAAAHlN5c3RlbS5XZWIuSHR0cFZhbHVlQ29sbGVjdGlvbgYAAAAIUmVhZE9ubHkLS2V5Q29tcGFyZXIFQ291bnQES2V5cwZWYWx1ZXMHVmVyc2lvbgADAAYFAAEWU3lzdGVtLk9yZGluYWxDb21wYXJlcggIAgAAAAAJAwAAAAMAAAAJBAAAAAkFAAAABAAAAAQDAAAAFlN5c3RlbS5PcmRpbmFsQ29tcGFyZXIBAAAAC19pZ25vcmVDYXNlAAEBEQQAAAADAAAABgYAAAADbnVtBgcAAAACZXAGCAAAAAJpcBAFAAAAAwAAAAkJAAAACQoAAAAJCwAAAAQJAAAAHFN5c3RlbS5Db2xsZWN0aW9ucy5BcnJheUxpc3QDAAAABl9pdGVtcwVfc2l6ZQhfdmVyc2lvbgUAAAgICQwAAAABAAAAAQAAAAEKAAAACQAAAAkNAAAAAQAAAAEAAAABCwAAAAkAAAAJDgAAAAEAAAABAAAAEAwAAAABAAAABg8AAAADNDQ1EA0AAAABAAAABhAAAAADNjgwEA4AAAABAAAABhEAAAAOMTIyLjIxNi4zMS4xNDULHglfTWVkaWFOdW0FAzQ0NR4JX3N0ckVwTnVtBQM2ODAeCF9DdXJQYWdlAgEeDF9yZWNvcmRDb3VudAKjE2QWDgIBDw8WAh8ABR1Ub3RhbCAyNDY3IHB1YmxpYyBsaW5rcyBmb3VuZGRkAgMPPCsACQEADxYEHghEYXRhS2V5cxYAHgtfIUl0ZW1Db3VudAIPZBYeZg9kFgICAQ8PFgIfAAW/AjxhIGhyZWY9ImdvbGluay5hc3B4P251bT00NDUmZXA9NjgwJnFsaW5rPWh0dHBzJTNhJTJmJTJmd3d3LnN1cGVydmlkLm5ldCUyZjIwMTklMmYxMiUyZmU2NzgxOTEyMjEuaHRtbCIgdGFyZ2V0PSJfYmxhbmsiPuyYge2ZlOqwgCDsoovri6QgKDxzcGFuIHN0eWxlPSJjb2xvcjpNYXJvb24iPlRvZGF5PC9zcGFuPik8L2E+PGJyIC8+PHNwYW4gc3R5bGU9ImNvbG9yOmdyZXkiPmh0dHBzOi8vPHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrO2ZvbnQtd2VpZ2h0OiBib2xkIj53d3cuc3VwZXJ2aWQubmV0PC9zcGFuPi8yMDE5LzEyL2U2NzgxOTEyMjEuaHRtbDwvc3Bhbj5kZAIBD2QWAgIBDw8WAh8ABccCPGEgaHJlZj0iZ29saW5rLmFzcHg/bnVtPTQ0NSZlcD02ODAmcWxpbms9aHR0cHMlM2ElMmYlMmZ3d3cuc3VwZXJ2aWQubmV0JTJmMjAxOSUyZjEyJTJmZTY3ODE5MTIyMV8yMC5odG1sIiB0YXJnZXQ9Il9ibGFuayI+7JiB7ZmU6rCAIOyii+uLpCAoPHNwYW4gc3R5bGU9ImNvbG9yOk1hcm9vbiI+VG9kYXk8L3NwYW4+KTwvYT48YnIgLz48c3BhbiBzdHlsZT0iY29sb3I6Z3JleSI+aHR0cHM6Ly88c3BhbiBzdHlsZT0iY29sb3I6YmxhY2s7Zm9udC13ZWlnaHQ6IGJvbGQiPnd3dy5zdXBlcnZpZC5uZXQ8L3NwYW4+LzIwMTkvMTIvZTY3ODE5MTIyMV8yMC5odG0uLi48L3NwYW4+ZGQCAg9kFgICAQ8PFgIfAAXpAjxhIGhyZWY9ImdvbGluay5hc3B4P251bT00NDUmZXA9NjgwJnFsaW5rPWh0dHBzJTNhJTJmJTJmd3d3LmZsYXNodmlkLm5ldCUyZjIwMTklMmYxMiUyZmU2NzgxOTEyMjEuaHRtbCIgdGFyZ2V0PSJfYmxhbmsiPuyYge2ZlOqwgCDsoovri6QgKDxzcGFuIHN0eWxlPSJjb2xvcjpNYXJvb24iPlRvZGF5PC9zcGFuPik8L2E+PGJyIC8+PHNwYW4gc3R5bGU9ImNvbG9yOmdyZXkiPmh0dHBzOi8vPHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrO2ZvbnQtd2VpZ2h0OiBib2xkIj53d3cuZmxhc2h2aWQubmV0PC9zcGFuPi8yMDE5LzEyL2U2NzgxOTEyMjEuaHRtbDwvc3Bhbj48aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJJTF9JTl9BUlRJQ0xFIj5kZAIDD2QWAgIBDw8WAh8ABccCPGEgaHJlZj0iZ29saW5rLmFzcHg/bnVtPTQ0NSZlcD02ODAmcWxpbms9aHR0cHMlM2ElMmYlMmZ3d3cuZmxhc2h2aWQubmV0JTJmMjAxOSUyZjEyJTJmZTY3ODE5MTIyMV8yMS5odG1sIiB0YXJnZXQ9Il9ibGFuayI+7JiB7ZmU6rCAIOyii+uLpCAoPHNwYW4gc3R5bGU9ImNvbG9yOk1hcm9vbiI+VG9kYXk8L3NwYW4+KTwvYT48YnIgLz48c3BhbiBzdHlsZT0iY29sb3I6Z3JleSI+aHR0cHM6Ly88c3BhbiBzdHlsZT0iY29sb3I6YmxhY2s7Zm9udC13ZWlnaHQ6IGJvbGQiPnd3dy5mbGFzaHZpZC5uZXQ8L3NwYW4+LzIwMTkvMTIvZTY3ODE5MTIyMV8yMS5odG0uLi48L3NwYW4+ZGQCBA9kFgICAQ8PFgIfAAXBAjxhIGhyZWY9ImdvbGluay5hc3B4P251bT00NDUmZXA9NjgwJnFsaW5rPWh0dHBzJTNhJTJmJTJmaXBmc3R1YmUuY2x1YiUyZjIlMmYlM2ZlbWJlZCUzZHBLQkszeEZzRWRMN3B3dnI4IiB0YXJnZXQ9Il9ibGFuayI+7JiB7ZmU6rCAIOyii+uLpCAoPHNwYW4gc3R5bGU9ImNvbG9yOk1hcm9vbiI+VG9kYXk8L3NwYW4+KTwvYT48YnIgLz48c3BhbiBzdHlsZT0iY29sb3I6Z3JleSI+aHR0cHM6Ly88c3BhbiBzdHlsZT0iY29sb3I6YmxhY2s7Zm9udC13ZWlnaHQ6IGJvbGQiPmlwZnN0dWJlLmNsdWI8L3NwYW4+LzIvP2VtYmVkPXBLQkszeEZzRWRMN3B3dnI4PC9zcGFuPmRkAgUPZBYCAgEPDxYCHwAFwQI8YSBocmVmPSJnb2xpbmsuYXNweD9udW09NDQ1JmVwPTY4MCZxbGluaz1odHRwcyUzYSUyZiUyZmlwZnN0dWJlLmNsdWIlMmYyJTJmJTNmZW1iZWQlM2RKbmJEcGdlcE1Faks3MkFqNiIgdGFyZ2V0PSJfYmxhbmsiPuyYge2ZlOqwgCDsoovri6QgKDxzcGFuIHN0eWxlPSJjb2xvcjpNYXJvb24iPlRvZGF5PC9zcGFuPik8L2E+PGJyIC8+PHNwYW4gc3R5bGU9ImNvbG9yOmdyZXkiPmh0dHBzOi8vPHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrO2ZvbnQtd2VpZ2h0OiBib2xkIj5pcGZzdHViZS5jbHViPC9zcGFuPi8yLz9lbWJlZD1KbmJEcGdlcE1Faks3MkFqNjwvc3Bhbj5kZAIGD2QWAgIBDw8WAh8ABcECPGEgaHJlZj0iZ29saW5rLmFzcHg/bnVtPTQ0NSZlcD02ODAmcWxpbms9aHR0cHMlM2ElMmYlMmZpcGZzdHViZS5jbHViJTJmMiUyZiUzZmVtYmVkJTNkYlpvNEVlOW5zNjhGZVJWcTgiIHRhcmdldD0iX2JsYW5rIj7smIHtmZTqsIAg7KKL64ukICg8c3BhbiBzdHlsZT0iY29sb3I6TWFyb29uIj5Ub2RheTwvc3Bhbj4pPC9hPjxiciAvPjxzcGFuIHN0eWxlPSJjb2xvcjpncmV5Ij5odHRwczovLzxzcGFuIHN0eWxlPSJjb2xvcjpibGFjaztmb250LXdlaWdodDogYm9sZCI+aXBmc3R1YmUuY2x1Yjwvc3Bhbj4vMi8/ZW1iZWQ9YlpvNEVlOW5zNjhGZVJWcTg8L3NwYW4+ZGQCBw9kFgICAQ8PFgIfAAXBAjxhIGhyZWY9ImdvbGluay5hc3B4P251bT00NDUmZXA9NjgwJnFsaW5rPWh0dHBzJTNhJTJmJTJmaXBmc3R1YmUuY2x1YiUyZjIlMmYlM2ZlbWJlZCUzZEx0REZiR2RiMmtSRkR4VHk2IiB0YXJnZXQ9Il9ibGFuayI+7JiB7ZmU6rCAIOyii+uLpCAoPHNwYW4gc3R5bGU9ImNvbG9yOk1hcm9vbiI+VG9kYXk8L3NwYW4+KTwvYT48YnIgLz48c3BhbiBzdHlsZT0iY29sb3I6Z3JleSI+aHR0cHM6Ly88c3BhbiBzdHlsZT0iY29sb3I6YmxhY2s7Zm9udC13ZWlnaHQ6IGJvbGQiPmlwZnN0dWJlLmNsdWI8L3NwYW4+LzIvP2VtYmVkPUx0REZiR2RiMmtSRkR4VHk2PC9zcGFuPmRkAggPZBYCAgEPDxYCHwAFwQI8YSBocmVmPSJnb2xpbmsuYXNweD9udW09NDQ1JmVwPTY4MCZxbGluaz1odHRwcyUzYSUyZiUyZmlwZnN0dWJlLmNsdWIlMmYyJTJmJTNmZW1iZWQlM2RGUVpQSDExZ3UxUlhWdE01QSIgdGFyZ2V0PSJfYmxhbmsiPuyYge2ZlOqwgCDsoovri6QgKDxzcGFuIHN0eWxlPSJjb2xvcjpNYXJvb24iPlRvZGF5PC9zcGFuPik8L2E+PGJyIC8+PHNwYW4gc3R5bGU9ImNvbG9yOmdyZXkiPmh0dHBzOi8vPHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrO2ZvbnQtd2VpZ2h0OiBib2xkIj5pcGZzdHViZS5jbHViPC9zcGFuPi8yLz9lbWJlZD1GUVpQSDExZ3UxUlhWdE01QTwvc3Bhbj5kZAIJD2QWAgIBDw8WAh8ABcECPGEgaHJlZj0iZ29saW5rLmFzcHg/bnVtPTQ0NSZlcD02ODAmcWxpbms9aHR0cHMlM2ElMmYlMmZpcGZzdHViZS5jbHViJTJmMiUyZiUzZmVtYmVkJTNkTW1raTFGY0h3eEd2Uk5LUjYiIHRhcmdldD0iX2JsYW5rIj7smIHtmZTqsIAg7KKL64ukICg8c3BhbiBzdHlsZT0iY29sb3I6TWFyb29uIj5Ub2RheTwvc3Bhbj4pPC9hPjxiciAvPjxzcGFuIHN0eWxlPSJjb2xvcjpncmV5Ij5odHRwczovLzxzcGFuIHN0eWxlPSJjb2xvcjpibGFjaztmb250LXdlaWdodDogYm9sZCI+aXBmc3R1YmUuY2x1Yjwvc3Bhbj4vMi8/ZW1iZWQ9TW1raTFGY0h3eEd2Uk5LUjY8L3NwYW4+ZGQCCg9kFgICAQ8PFgIfAAWhAjxhIGhyZWY9ImdvbGluay5hc3B4P251bT00NDUmZXA9NjgwJnFsaW5rPWh0dHBzJTNhJTJmJTJmaGxzcGxheS5jb20lMmZlJTJmS1cwWU1QWnliZVVNIiB0YXJnZXQ9Il9ibGFuayI+7JiB7ZmU6rCAIOyii+uLpCAoPHNwYW4gc3R5bGU9ImNvbG9yOk1hcm9vbiI+VG9kYXk8L3NwYW4+KTwvYT48YnIgLz48c3BhbiBzdHlsZT0iY29sb3I6Z3JleSI+aHR0cHM6Ly88c3BhbiBzdHlsZT0iY29sb3I6YmxhY2s7Zm9udC13ZWlnaHQ6IGJvbGQiPmhsc3BsYXkuY29tPC9zcGFuPi9lL0tXMFlNUFp5YmVVTTwvc3Bhbj5kZAILD2QWAgIBDw8WAh8ABaECPGEgaHJlZj0iZ29saW5rLmFzcHg/bnVtPTQ0NSZlcD02ODAmcWxpbms9aHR0cHMlM2ElMmYlMmZobHNwbGF5LmNvbSUyZmUlMmYxMXIxUTFMZExud0IiIHRhcmdldD0iX2JsYW5rIj7smIHtmZTqsIAg7KKL64ukICg8c3BhbiBzdHlsZT0iY29sb3I6TWFyb29uIj5Ub2RheTwvc3Bhbj4pPC9hPjxiciAvPjxzcGFuIHN0eWxlPSJjb2xvcjpncmV5Ij5odHRwczovLzxzcGFuIHN0eWxlPSJjb2xvcjpibGFjaztmb250LXdlaWdodDogYm9sZCI+aGxzcGxheS5jb208L3NwYW4+L2UvMTFyMVExTGRMbndCPC9zcGFuPmRkAgwPZBYCAgEPDxYCHwAFoQI8YSBocmVmPSJnb2xpbmsuYXNweD9udW09NDQ1JmVwPTY4MCZxbGluaz1odHRwcyUzYSUyZiUyZmhsc3BsYXkuY29tJTJmZSUyZlBkQUZMNEx4elM0QyIgdGFyZ2V0PSJfYmxhbmsiPuyYge2ZlOqwgCDsoovri6QgKDxzcGFuIHN0eWxlPSJjb2xvcjpNYXJvb24iPlRvZGF5PC9zcGFuPik8L2E+PGJyIC8+PHNwYW4gc3R5bGU9ImNvbG9yOmdyZXkiPmh0dHBzOi8vPHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrO2ZvbnQtd2VpZ2h0OiBib2xkIj5obHNwbGF5LmNvbTwvc3Bhbj4vZS9QZEFGTDRMeHpTNEM8L3NwYW4+ZGQCDQ9kFgICAQ8PFgIfAAWhAjxhIGhyZWY9ImdvbGluay5hc3B4P251bT00NDUmZXA9NjgwJnFsaW5rPWh0dHBzJTNhJTJmJTJmaGxzcGxheS5jb20lMmZlJTJmazZIOGhyM2pDWGRHIiB0YXJnZXQ9Il9ibGFuayI+7JiB7ZmU6rCAIOyii+uLpCAoPHNwYW4gc3R5bGU9ImNvbG9yOk1hcm9vbiI+VG9kYXk8L3NwYW4+KTwvYT48YnIgLz48c3BhbiBzdHlsZT0iY29sb3I6Z3JleSI+aHR0cHM6Ly88c3BhbiBzdHlsZT0iY29sb3I6YmxhY2s7Zm9udC13ZWlnaHQ6IGJvbGQiPmhsc3BsYXkuY29tPC9zcGFuPi9lL2s2SDhocjNqQ1hkRzwvc3Bhbj5kZAIOD2QWAgIBDw8WAh8ABaECPGEgaHJlZj0iZ29saW5rLmFzcHg/bnVtPTQ0NSZlcD02ODAmcWxpbms9aHR0cHMlM2ElMmYlMmZqZXRsb2FkLm5ldCUyZmUlMmZLVzBZTVBaeWJlVU0iIHRhcmdldD0iX2JsYW5rIj7smIHtmZTqsIAg7KKL64ukICg8c3BhbiBzdHlsZT0iY29sb3I6TWFyb29uIj5Ub2RheTwvc3Bhbj4pPC9hPjxiciAvPjxzcGFuIHN0eWxlPSJjb2xvcjpncmV5Ij5odHRwczovLzxzcGFuIHN0eWxlPSJjb2xvcjpibGFjaztmb250LXdlaWdodDogYm9sZCI+amV0bG9hZC5uZXQ8L3NwYW4+L2UvS1cwWU1QWnliZVVNPC9zcGFuPmRkAgUPFgIfCAIHFg5mD2QWAgIBDw8WCh8ABQExHg9Db21tYW5kQXJndW1lbnQFATEeCENzc0NsYXNzBQ1wYWdlX2Rpc2FibGVkHg1PbkNsaWVudENsaWNrBQ1yZXR1cm4gZmFsc2U7HgRfIVNCAgJkZAIBD2QWAgIBDw8WCh8ABQEyHwkFATIfCgUMcGFnZV9lbmFibGVkHwtlHwwCAmRkAgIPZBYCAgEPDxYKHwAFATMfCQUBMx8KBQxwYWdlX2VuYWJsZWQfC2UfDAICZGQCAw9kFgICAQ8PFgofAAUBNB8JBQE0HwoFDHBhZ2VfZW5hYmxlZB8LZR8MAgJkZAIED2QWAgIBDw8WCh8ABQE1HwkFATUfCgUMcGFnZV9lbmFibGVkHwtlHwwCAmRkAgUPZBYCAgEPDxYKHwAFAj4+HwkFATIfCgUMcGFnZV9lbmFibGVkHwtlHwwCAmRkAgYPZBYCAgEPDxYKHwAFBExhc3QfCQUDMTY1HwoFDHBhZ2VfZW5hYmxlZB8LZR8MAgJkZAIHDw8WAh8ABbsBPGlmcmFtZSBzcmM9Ik1lZGlhVGh1bW5haWwuYXNweD9pbWc9MTI0MTg5NDA5MW1tbS5qcGcmYWx0PeyYge2ZlOqwgCDsoovri6Qmdz0xNDYmaD0xMDAiIHdpZHRoPSIxNDYiIGhlaWdodD0iMTAwIiBzY3JvbGxpbmc9Im5vIiBmcmFtZWJvcmRlcj0iMCIgbWFyZ2lud2lkdGg9IjAiIG1hcmdpbmhlaWdodD0iMCIgPjwvaWZyYW1lPmRkAgsPDxYCHwAFGeyYge2ZlOqwgCDsoovri6QgLSDsmKTrnb1kZAIPDw8WAh8AZWRkAhEPDxYCHwAFezxhIGhyZWY9IiIgdGFyZ2V0PSJfYmxhbmsiPuqzteyLnSDtmYjtjpjsnbTsp4A8L2E+Jm5ic3A7Jm5ic3A7PGEgaHJlZj0icmVMaXN0LmFzcHg/bnVtPTQ0NSIgdGFyZ2V0PSJfc2VsZiI+64uk7Iuc67O06riwPC9hPmRkAgUPFgIfAAW8ATxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4gdmFyIGluZm9saW5rc19waWQgPSAzMTU2MTk2OyB2YXIgaW5mb2xpbmtzX3dzaWQgPSAwOyA8L3NjcmlwdD4gPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iLy9yZXNvdXJjZXMuaW5mb2xpbmtzLmNvbS9qcy9pbmZvbGlua3NfbWFpbi5qcyI+PC9zY3JpcHQ+ZGTULCTJU6nLU+mgULWgi0SrZTgg9w==",
                "__VIEWSTATEGENERATOR" to "111DFAF7",
                "__EVENTVALIDATION" to "/wEWCQK38/uoBALqvpf4BAL4mcvwCAL4mbfrCwL4maM2AviZj7EDAviZ+6sBAviZ56YEAviZ04gB0E5AXdX+SedhQjCjNo8YBnoPwJU="
            ),
            actual = programViewer.nextKey
        )
    }

    private fun readHtml(filename: String, charset: Charset): String =
        ClassLoader
            .getSystemClassLoader()
            .getResourceAsStream(filename)
            .bufferedReader(charset)
            .use(Reader::readText)

    private fun createParser(
        filename: String,
        charset: Charset = Charsets.UTF_8
    ) = ProgramViewerPageParser(readHtml(filename, charset))
}
